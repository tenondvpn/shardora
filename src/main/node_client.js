const Web3 = require('web3')
var net = require('net');
var web3 = new Web3(new Web3.providers.IpcProvider('/Users/myuser/Library/Ethereum/geth.ipc', net));
const { randomBytes } = require('crypto')
const Secp256k1 = require('./secp256k1_1')
const keccak256 = require('keccak256')
var querystring = require('querystring');
var http = require('http');
var fs = require('fs');

function hexToBytes(hex) {
    for (var bytes = [], c = 0; c < hex.length; c += 2)
        bytes.push(parseInt(hex.substr(c, 2), 16));
    return bytes;
}

function PostCode(data) {
    var post_data = querystring.stringify(data);
    var post_options = {
        host: '127.0.0.1',
        port: '8781',
        path: '/transaction',
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
            'Content-Length': Buffer.byteLength(post_data)
        }
    };

    var post_req = http.request(post_options, function (res) {
        res.setEncoding('utf8');
        res.on('data', function (chunk) {
            if (chunk != "ok") {
                console.log('Response: ' + chunk + ", " + data);
            } else {
                console.log('Response: ' + chunk + ", " + data);
            }
        })
    });

    post_req.write(post_data);
    post_req.end();
}

function GetValidHexString(uint256_bytes) {
    var str_res = uint256_bytes.toString(16)
    while (str_res.length < 64) {
        str_res = "0" + str_res;
    }

    return str_res;
}

function param_contract(tx_type, gid, to, amount, gas_limit, gas_price, contract_bytes, input, prepay) {
    // 私钥
    const privateKeyBuf = Secp256k1.uint256("fa04ebee157c6c10bd9d250fc2c938780bf68cbe30e9f0d7c048e4d081907971", 16)
    var self_private_key = Secp256k1.uint256(privateKeyBuf, 16)
    var self_public_key = Secp256k1.generatePublicKeyFromPrivateKeyData(self_private_key)

    // 将内容编码
    var gid = GetValidHexString(Secp256k1.uint256(randomBytes(32)));
    var frompk = '04' + self_public_key.x.toString(16) + self_public_key.y.toString(16);
    const MAX_UINT32 = 0xFFFFFFFF;
    var amount_buf = new Buffer(8);
    var big = ~~(amount / MAX_UINT32)
    var low = (amount % MAX_UINT32) - big
    amount_buf.writeUInt32LE(big, 4)
    amount_buf.writeUInt32LE(low, 0)

    var gas_limit_buf = new Buffer(8);
    var big = ~~(gas_limit / MAX_UINT32)
    var low = (gas_limit % MAX_UINT32) - big
    gas_limit_buf.writeUInt32LE(big, 4)
    gas_limit_buf.writeUInt32LE(low, 0)

    var gas_price_buf = new Buffer(8);
    var big = ~~(gas_price / MAX_UINT32)
    var low = (gas_price % MAX_UINT32) - big
    gas_price_buf.writeUInt32LE(big, 4)
    gas_price_buf.writeUInt32LE(low, 0)

    var step_buf = new Buffer(8);
    var big = ~~(tx_type / MAX_UINT32)
    var low = (tx_type % MAX_UINT32) - big
    step_buf.writeUInt32LE(big, 0)
    step_buf.writeUInt32LE(low, 0)

    var prepay_buf = new Buffer(8);
    var big = ~~(prepay / MAX_UINT32)
    var low = (prepay % MAX_UINT32) - big
    prepay_buf.writeUInt32LE(big, 4)
    prepay_buf.writeUInt32LE(low, 0)

    var message_buf = Buffer.concat([Buffer.from(gid, 'hex'), Buffer.from(frompk, 'hex'), Buffer.from(to, 'hex'),
        amount_buf, gas_limit_buf, gas_price_buf, step_buf, Buffer.from(contract_bytes, 'hex'), Buffer.from(input, 'hex'), prepay_buf]);

    // 签名
    var kechash = keccak256(message_buf)
    var digest = Secp256k1.uint256(kechash, 16)
    const sig = Secp256k1.ecsign(self_private_key, digest)
    const sigR = Secp256k1.uint256(sig.r, 16)
    const sigS = Secp256k1.uint256(sig.s, 16)

    // 发送给链的交易参数
    return {
        'gid': gid,
        'pubkey': '04' + self_public_key.x.toString(16) + self_public_key.y.toString(16),
        'to': to,
        'amount': amount,
        'gas_limit': gas_limit,
        'gas_price': gas_price,
        'type': tx_type,
        'shard_id': 3,
        'hash': kechash,
        'attrs_size': 4,
        "bytes_code": contract_bytes,
        "input": input,
        "pepay": prepay,
        'sign_r': sigR.toString(16),
        'sign_s': sigS.toString(16),
        'sign_v': sig.v,
    }
}

function create_tx(to, amount, gas_limit, gas_price) {
    // 私钥
    const privateKeyBuf = Secp256k1.uint256("fa04ebee157c6c10bd9d250fc2c938780bf68cbe30e9f0d7c048e4d081907971", 16)
    var self_private_key = Secp256k1.uint256(privateKeyBuf, 16)
    var self_public_key = Secp256k1.generatePublicKeyFromPrivateKeyData(self_private_key)

    // 将内容编码
    var gid = GetValidHexString(Secp256k1.uint256(randomBytes(32)));
    var tx_type = 0;
    var frompk = '04' + self_public_key.x.toString(16) + self_public_key.y.toString(16);
    const MAX_UINT32 = 0xFFFFFFFF;
    var amount_buf = new Buffer(8);
    var big = ~~(amount / MAX_UINT32)
    var low = (amount % MAX_UINT32) - big
    amount_buf.writeUInt32LE(big, 4)
    amount_buf.writeUInt32LE(low, 0)

    var gas_limit_buf = new Buffer(8);
    var big = ~~(gas_limit / MAX_UINT32)
    var low = (gas_limit % MAX_UINT32) - big
    gas_limit_buf.writeUInt32LE(big, 4)
    gas_limit_buf.writeUInt32LE(low, 0)

    var gas_price_buf = new Buffer(8);
    var big = ~~(gas_price / MAX_UINT32)
    var low = (gas_price % MAX_UINT32) - big
    gas_price_buf.writeUInt32LE(big, 4)
    gas_price_buf.writeUInt32LE(low, 0)
    var step_buf = new Buffer(8);
    var big = ~~(tx_type / MAX_UINT32)
    var low = (tx_type % MAX_UINT32) - big
    step_buf.writeUInt32LE(big, 0)
    step_buf.writeUInt32LE(low, 0)

    var message_buf = Buffer.concat([Buffer.from(gid, 'hex'), Buffer.from(frompk, 'hex'), Buffer.from(to, 'hex'),
        amount_buf, gas_limit_buf, gas_price_buf, step_buf]);

    // 签名
    var kechash = keccak256(message_buf)
    var digest = Secp256k1.uint256(kechash, 16)
    const sig = Secp256k1.ecsign(self_private_key, digest)
    const sigR = Secp256k1.uint256(sig.r, 16)
    const sigS = Secp256k1.uint256(sig.s, 16)

    // 发送给链的交易参数
    return {
        'gid': gid,
        'pubkey': '04' + self_public_key.x.toString(16) + self_public_key.y.toString(16),
        'to': to,
        'amount': amount,
        'gas_limit': gas_limit,
        'gas_price': gas_price,
        'type': tx_type,
        'shard_id': 3,
        'sign_r': sigR.toString(16),
        'sign_s': sigS.toString(16),
        'sign_v': sig.v,
    }
}

// 创建合约
function new_contract(contract_bytes) {
    var gid = GetValidHexString(Secp256k1.uint256(randomBytes(32)));
    const privateKeyBuf = Secp256k1.uint256("fa04ebee157c6c10bd9d250fc2c938780bf68cbe30e9f0d7c048e4d081907971", 16)
    var self_private_key = Secp256k1.uint256(privateKeyBuf, 16)
    var self_public_key = Secp256k1.generatePublicKeyFromPrivateKeyData(self_private_key)
    var pk_bytes = hexToBytes(self_public_key.x.toString(16) + self_public_key.y.toString(16))
    var address = keccak256(pk_bytes).toString('hex')
    var self_account_id = address.slice(address.length - 40, address.length)
    var kechash = keccak256(self_account_id + gid + contract_bytes).toString('hex')
    var self_contract_address = kechash.slice(kechash.length - 40, kechash.length)
    var data = param_contract(
        6,
        gid,
        self_contract_address,
        10000000,
        10000000,
        1,
        contract_bytes,
        "",
        999999999);
    PostCode(data);

    const opt = { flag: 'w', }
    fs.writeFile('contract_address', self_contract_address, opt, (err) => {
        if (err) {
            console.error(err)
        }
    })
}

// 调用合约
function call_contract(input) {
    var contract_address = fs.readFileSync('contract_address', 'utf-8');
    var gid = GetValidHexString(Secp256k1.uint256(randomBytes(32)));
    var data = param_contract(
        8,
        gid,
        contract_address,
        10000000,
        10000000,
        1,
        "",
        input,
        0);
    PostCode(data);
}

// 普通交易和kv写入
function do_transaction(to_addr, amount, gas_limit, gas_price, key, value) {
    var data = create_tx(to_addr, amount, gas_limit, gas_price);
    PostCode(data);
}

const args = process.argv.slice(2)
// 普通交易，并写入kv数据
if (args[0] == 0) {
    do_transaction(args[1], 100000, 10000, 1, "key", "value");
}

// 创建合约 phr.sol
if (args[0] == 1) {
    new_contract("6080604052604051620021f7380380620021f7833981810160405281019062000029919062000326565b8060009080519060200190620000419291906200008a565b5033600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505062000377565b82805482825590600052602060002090810192821562000106579160200282015b82811115620001055782518260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555091602001919060010190620000ab565b5b50905062000115919062000119565b5090565b5b80821115620001345760008160009055506001016200011a565b5090565b6000604051905090565b600080fd5b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6200019c8262000151565b810181811067ffffffffffffffff82111715620001be57620001bd62000162565b5b80604052505050565b6000620001d362000138565b9050620001e1828262000191565b919050565b600067ffffffffffffffff82111562000204576200020362000162565b5b602082029050602081019050919050565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b600062000247826200021a565b9050919050565b62000259816200023a565b81146200026557600080fd5b50565b60008151905062000279816200024e565b92915050565b6000620002966200029084620001e6565b620001c7565b90508083825260208201905060208402830185811115620002bc57620002bb62000215565b5b835b81811015620002e95780620002d4888262000268565b845260208401935050602081019050620002be565b5050509392505050565b600082601f8301126200030b576200030a6200014c565b5b81516200031d8482602086016200027f565b91505092915050565b6000602082840312156200033f576200033e62000142565b5b600082015167ffffffffffffffff81111562000360576200035f62000147565b5b6200036e84828501620002f3565b91505092915050565b611e7080620003876000396000f3fe6080604052600436106100f35760003560e01c80637e2803781161008a578063b89e70b511610059578063b89e70b51461038b578063cfefc010146103c8578063e9c7feda146103d2578063fdba8f111461040f576100f3565b80637e280378146102a65780638da5cb5b146102e5578063a51f8aac14610310578063ae0ad9d91461034e576100f3565b80635f13d6ee116100c65780635f13d6ee146101da5780636189d2df14610217578063691b3463146102405780636b83e05914610269576100f3565b806308ad872a146100f85780630ef403f81461012157806329c1cb4b1461015e5780634819544b1461019b575b600080fd5b34801561010457600080fd5b5061011f600480360381019061011a9190611291565b610438565b005b34801561012d57600080fd5b506101486004803603810190610143919061131c565b6105a0565b6040516101559190611364565b60405180910390f35b34801561016a57600080fd5b506101856004803603810190610180919061137f565b6105cd565b6040516101929190611364565b60405180910390f35b3480156101a757600080fd5b506101c260048036038101906101bd9190611411565b610614565b6040516101d19392919061146f565b60405180910390f35b3480156101e657600080fd5b5061020160048036038101906101fc91906114a6565b610668565b60405161020e9190611514565b60405180910390f35b34801561022357600080fd5b5061023e600480360381019061023991906116b5565b6106a7565b005b34801561024c57600080fd5b5061026760048036038101906102629190611754565b610885565b005b34801561027557600080fd5b50610290600480360381019061028b919061137f565b610992565b60405161029d9190611364565b60405180910390f35b3480156102b257600080fd5b506102cd60048036038101906102c8919061131c565b6109d7565b6040516102dc9392919061185e565b60405180910390f35b3480156102f157600080fd5b506102fa610b1e565b60405161030791906118c4565b60405180910390f35b34801561031c57600080fd5b506103376004803603810190610332919061131c565b610b44565b6040516103459291906118df565b60405180910390f35b34801561035a57600080fd5b5061037560048036038101906103709190611908565b610b75565b6040516103829190611364565b60405180910390f35b34801561039757600080fd5b506103b260048036038101906103ad919061131c565b610bba565b6040516103bf9190611364565b60405180910390f35b6103d0610c41565b005b3480156103de57600080fd5b506103f960048036038101906103f4919061137f565b610c7c565b6040516104069190611364565b60405180910390f35b34801561041b57600080fd5b5061043660048036038101906104319190611291565b610d95565b005b80516000805490501461044a57600080fd5b60005b815181101561050a576000818154811061046a57610469611964565b5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166104d76104b785610f4a565b8484815181106104ca576104c9611964565b5b6020026020010151610f7a565b73ffffffffffffffffffffffffffffffffffffffff16146104f757600080fd5b8080610502906119c2565b91505061044d565b50600160038460405161051d9190611a46565b9081526020016040518091039020600084815260200190815260200160002060006101000a81548160ff021916908315150217905550600160046000848152602001908152602001600020846040516105769190611a46565b908152602001604051809103902060006101000a81548160ff021916908315150217905550505050565b60006002600083815260200190815260200160002060020160009054906101000a900460ff169050919050565b60006003836040516105df9190611a46565b9081526020016040518091039020600083815260200190815260200160002060009054906101000a900460ff16905092915050565b6005602052816000526040600020818154811061063057600080fd5b9060005260206000209060030201600091509150508060000154908060010154908060020160009054906101000a900460ff16905083565b6000818154811061067857600080fd5b906000526020600020016000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b3373ffffffffffffffffffffffffffffffffffffffff16600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461070157600080fd5b6006600085815260200190815260200160002060010160009054906101000a900460ff161561072f57600080fd5b805182511461073d57600080fd5b604051806040016040528084815260200160011515815250600660008681526020019081526020016000206000820151816000015560208201518160010160006101000a81548160ff02191690831515021790555090505060008251905060005b8181101561087d576005600086815260200190815260200160002060405180606001604052808684815181106107d7576107d6611964565b5b602002602001015181526020018584815181106107f7576107f6611964565b5b60200260200101518152602001600115158152509080600181540180825580915050600190039060005260206000209060030201600090919091909150600082015181600001556020820151816001015560408201518160020160006101000a81548160ff02191690831515021790555050508080610875906119c2565b91505061079e565b505050505050565b3373ffffffffffffffffffffffffffffffffffffffff16600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16146108df57600080fd5b6002600084815260200190815260200160002060020160009054906101000a900460ff161561090d57600080fd5b6040518060600160405280838152602001828152602001600115158152506002600085815260200190815260200160002060008201518160000190816109539190611c69565b5060208201518160010190816109699190611c69565b5060408201518160020160006101000a81548160ff021916908315150217905550905050505050565b6003828051602081018201805184825260208301602085012081835280955050505050506020528060005260406000206000915091509054906101000a900460ff1681565b60026020528060005260406000206000915090508060000180546109fa90611a8c565b80601f0160208091040260200160405190810160405280929190818152602001828054610a2690611a8c565b8015610a735780601f10610a4857610100808354040283529160200191610a73565b820191906000526020600020905b815481529060010190602001808311610a5657829003601f168201915b505050505090806001018054610a8890611a8c565b80601f0160208091040260200160405190810160405280929190818152602001828054610ab490611a8c565b8015610b015780601f10610ad657610100808354040283529160200191610b01565b820191906000526020600020905b815481529060010190602001808311610ae457829003601f168201915b5050505050908060020160009054906101000a900460ff16905083565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60066020528060005260406000206000915090508060000154908060010160009054906101000a900460ff16905082565b6004602052816000526040600020818051602081018201805184825260208301602085012081835280955050505050506000915091509054906101000a900460ff1681565b60003373ffffffffffffffffffffffffffffffffffffffff16600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614610c1657600080fd5b6006600083815260200190815260200160002060010160009054906101000a900460ff169050919050565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16ff5b6000806005600084815260200190815260200160002080549050905060008111610ca557600080fd5b60005b81811015610d885760046000600560008781526020019081526020016000208381548110610cd957610cd8611964565b5b906000526020600020906003020160000154815260200190815260200160002085604051610d079190611a46565b908152602001604051809103902060009054906101000a900460ff168015610d65575042600560008681526020019081526020016000208281548110610d5057610d4f611964565b5b90600052602060002090600302016001015410155b15610d7557600192505050610d8f565b8080610d80906119c2565b915050610ca8565b5060009150505b92915050565b805160008054905014610da757600080fd5b60001515600384604051610dbb9190611a46565b9081526020016040518091039020600084815260200190815260200160002060009054906101000a900460ff16151514610df457600080fd5b60005b8151811015610eb45760008181548110610e1457610e13611964565b5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16610e81610e6185610f4a565b848481518110610e7457610e73611964565b5b6020026020010151610f7a565b73ffffffffffffffffffffffffffffffffffffffff1614610ea157600080fd5b8080610eac906119c2565b915050610df7565b506001600384604051610ec79190611a46565b9081526020016040518091039020600084815260200190815260200160002060006101000a81548160ff02191690831515021790555060016004600084815260200190815260200160002084604051610f209190611a46565b908152602001604051809103902060006101000a81548160ff021916908315150217905550505050565b600081604051602001610f5d9190611db3565b604051602081830303815290604052805190602001209050919050565b600080600080610f8985610fe9565b92509250925060018684848460405160008152602001604052604051610fb29493929190611df5565b6020604051602081039080840390855afa158015610fd4573d6000803e3d6000fd5b50505060206040510351935050505092915050565b60008060006041845114610ffc57600080fd5b6020840151915060408401519050606084015160001a92509193909250565b6000604051905090565b600080fd5b600080fd5b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b61108282611039565b810181811067ffffffffffffffff821117156110a1576110a061104a565b5b80604052505050565b60006110b461101b565b90506110c08282611079565b919050565b600067ffffffffffffffff8211156110e0576110df61104a565b5b6110e982611039565b9050602081019050919050565b82818337600083830152505050565b6000611118611113846110c5565b6110aa565b90508281526020810184848401111561113457611133611034565b5b61113f8482856110f6565b509392505050565b600082601f83011261115c5761115b61102f565b5b813561116c848260208601611105565b91505092915050565b6000819050919050565b61118881611175565b811461119357600080fd5b50565b6000813590506111a58161117f565b92915050565b600067ffffffffffffffff8211156111c6576111c561104a565b5b602082029050602081019050919050565b600080fd5b60006111ef6111ea846111ab565b6110aa565b90508083825260208201905060208402830185811115611212576112116111d7565b5b835b8181101561125957803567ffffffffffffffff8111156112375761123661102f565b5b8086016112448982611147565b85526020850194505050602081019050611214565b5050509392505050565b600082601f8301126112785761127761102f565b5b81356112888482602086016111dc565b91505092915050565b6000806000606084860312156112aa576112a9611025565b5b600084013567ffffffffffffffff8111156112c8576112c761102a565b5b6112d486828701611147565b93505060206112e586828701611196565b925050604084013567ffffffffffffffff8111156113065761130561102a565b5b61131286828701611263565b9150509250925092565b60006020828403121561133257611331611025565b5b600061134084828501611196565b91505092915050565b60008115159050919050565b61135e81611349565b82525050565b60006020820190506113796000830184611355565b92915050565b6000806040838503121561139657611395611025565b5b600083013567ffffffffffffffff8111156113b4576113b361102a565b5b6113c085828601611147565b92505060206113d185828601611196565b9150509250929050565b6000819050919050565b6113ee816113db565b81146113f957600080fd5b50565b60008135905061140b816113e5565b92915050565b6000806040838503121561142857611427611025565b5b600061143685828601611196565b9250506020611447858286016113fc565b9150509250929050565b61145a81611175565b82525050565b611469816113db565b82525050565b60006060820190506114846000830186611451565b6114916020830185611460565b61149e6040830184611355565b949350505050565b6000602082840312156114bc576114bb611025565b5b60006114ca848285016113fc565b91505092915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006114fe826114d3565b9050919050565b61150e816114f3565b82525050565b60006020820190506115296000830184611505565b92915050565b600067ffffffffffffffff82111561154a5761154961104a565b5b602082029050602081019050919050565b600061156e6115698461152f565b6110aa565b90508083825260208201905060208402830185811115611591576115906111d7565b5b835b818110156115ba57806115a68882611196565b845260208401935050602081019050611593565b5050509392505050565b600082601f8301126115d9576115d861102f565b5b81356115e984826020860161155b565b91505092915050565b600067ffffffffffffffff82111561160d5761160c61104a565b5b602082029050602081019050919050565b600061163161162c846115f2565b6110aa565b90508083825260208201905060208402830185811115611654576116536111d7565b5b835b8181101561167d578061166988826113fc565b845260208401935050602081019050611656565b5050509392505050565b600082601f83011261169c5761169b61102f565b5b81356116ac84826020860161161e565b91505092915050565b600080600080608085870312156116cf576116ce611025565b5b60006116dd87828801611196565b94505060206116ee87828801611196565b935050604085013567ffffffffffffffff81111561170f5761170e61102a565b5b61171b878288016115c4565b925050606085013567ffffffffffffffff81111561173c5761173b61102a565b5b61174887828801611687565b91505092959194509250565b60008060006060848603121561176d5761176c611025565b5b600061177b86828701611196565b935050602084013567ffffffffffffffff81111561179c5761179b61102a565b5b6117a886828701611147565b925050604084013567ffffffffffffffff8111156117c9576117c861102a565b5b6117d586828701611147565b9150509250925092565b600081519050919050565b600082825260208201905092915050565b60005b838110156118195780820151818401526020810190506117fe565b60008484015250505050565b6000611830826117df565b61183a81856117ea565b935061184a8185602086016117fb565b61185381611039565b840191505092915050565b600060608201905081810360008301526118788186611825565b9050818103602083015261188c8185611825565b905061189b6040830184611355565b949350505050565b60006118ae826114d3565b9050919050565b6118be816118a3565b82525050565b60006020820190506118d960008301846118b5565b92915050565b60006040820190506118f46000830185611451565b6119016020830184611355565b9392505050565b6000806040838503121561191f5761191e611025565b5b600061192d85828601611196565b925050602083013567ffffffffffffffff81111561194e5761194d61102a565b5b61195a85828601611147565b9150509250929050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b60006119cd826113db565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82036119ff576119fe611993565b5b600182019050919050565b600081905092915050565b6000611a20826117df565b611a2a8185611a0a565b9350611a3a8185602086016117fb565b80840191505092915050565b6000611a528284611a15565b915081905092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b60006002820490506001821680611aa457607f821691505b602082108103611ab757611ab6611a5d565b5b50919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b600060088302611b1f7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82611ae2565b611b298683611ae2565b95508019841693508086168417925050509392505050565b6000819050919050565b6000611b66611b61611b5c846113db565b611b41565b6113db565b9050919050565b6000819050919050565b611b8083611b4b565b611b94611b8c82611b6d565b848454611aef565b825550505050565b600090565b611ba9611b9c565b611bb4818484611b77565b505050565b5b81811015611bd857611bcd600082611ba1565b600181019050611bba565b5050565b601f821115611c1d57611bee81611abd565b611bf784611ad2565b81016020851015611c06578190505b611c1a611c1285611ad2565b830182611bb9565b50505b505050565b600082821c905092915050565b6000611c4060001984600802611c22565b1980831691505092915050565b6000611c598383611c2f565b9150826002028217905092915050565b611c72826117df565b67ffffffffffffffff811115611c8b57611c8a61104a565b5b611c958254611a8c565b611ca0828285611bdc565b600060209050601f831160018114611cd35760008415611cc1578287015190505b611ccb8582611c4d565b865550611d33565b601f198416611ce186611abd565b60005b82811015611d0957848901518255600182019150602085019450602081019050611ce4565b86831015611d265784890151611d22601f891682611c2f565b8355505b6001600288020188555050505b505050505050565b600081905092915050565b7f19457468657265756d205369676e6564204d6573736167653a0a333200000000600082015250565b6000611d7c601c83611d3b565b9150611d8782611d46565b601c82019050919050565b6000819050919050565b611dad611da882611175565b611d92565b82525050565b6000611dbe82611d6f565b9150611dca8284611d9c565b60208201915081905092915050565b600060ff82169050919050565b611def81611dd9565b82525050565b6000608082019050611e0a6000830187611451565b611e176020830186611de6565b611e246040830185611451565b611e316060830184611451565b9594505050505056fea2646970667358221220d430c78872d9409324709f668d57e36da7ecf41a587504dfb926267427a182b964736f6c6343000811003300000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000003000000000000000000000000e252d01a37b85e2007ed3cc13797aa92496204a40000000000000000000000005f15294a1918633d4dd4ec47098a14d01c58e957000000000000000000000000d45cfd6855c6ec8f635a6f2b46c647e99c59c79d");
}

// 调用合约 phr.sol 的 ResAdd 函数
if (args[0] == 2) {
    call_contract("cfefc010");
}
